{"version":3,"sources":["buttons/FontScaleButton.js"],"names":["define","$","extend","SimpleModule","Toolbar","Simditor","Button","FontScaleButton","inherit","prototype","name","icon","htmlTag","disableTag","sizeMap","x-large","large","small","x-small","_init","this","menu","text","_t","param","call","_activeStatus","active","endNode","endNodes","startNode","startNodes","editor","selection","range","filter","length","is","setActive","command","containerNode","_this","collapsed","document","execCommand","reset","nodeType","Node","TEXT_NODE","closest","find","each","i","n","$span","size","style","fontSize","test","css","replaceWith","contents","trigger","addButton"],"mappings":";;;;;;;AAAAA,QACE,iBACA,aACA,YACA,aACA,cACA,aACA,SAASC,EAAEC,EAAOC,EAAaC,EAAQC,EAASC,GAC/C,IAAIC,EAAkBD,EAAOE,YAmG9B,OA7FAD,EAAgBE,UAAUC,KAAO,YAEjCH,EAAgBE,UAAUE,KAAO,OAEjCJ,EAAgBE,UAAUG,QAAU,OAEpCL,EAAgBE,UAAUI,WAAa,0BAEvCN,EAAgBE,UAAUK,SACxBC,UAAW,QACXC,MAAS,SACTC,MAAS,QACTC,UAAW,QAGbX,EAAgBE,UAAUU,MAAQ,WAwBhC,OAvBAC,KAAKC,OAEDX,KAAM,OACNY,KAAMF,KAAKG,GAAG,mBACdC,MAAO,MAEPd,KAAM,OACNY,KAAMF,KAAKG,GAAG,kBACdC,MAAO,MAEPd,KAAM,OACNY,KAAMF,KAAKG,GAAG,mBACdC,MAAO,MAEPd,KAAM,MACNY,KAAMF,KAAKG,GAAG,kBACdC,MAAO,MAEPd,KAAM,MACNY,KAAMF,KAAKG,GAAG,mBACdC,MAAO,MAGJlB,EAAOG,UAAUU,MAAMM,KAAKL,OAGrCb,EAAgBE,UAAUiB,cAAgB,WACxC,IAAIC,EAAQC,EAASC,EAAiBC,EAAWC,EAQjD,OAPQX,KAAKY,OAAOC,UAAUC,QAC9BH,EAAaX,KAAKY,OAAOC,UAAUF,aACnCF,EAAWT,KAAKY,OAAOC,UAAUJ,WACjCC,EAAYC,EAAWI,OAAO,4BAC9BP,EAAUC,EAASM,OAAO,4BAC1BR,EAASI,EAAWK,OAAS,GAAKP,EAASO,OAAS,GAAKN,EAAUO,GAAGT,GACtER,KAAKkB,UAAUX,GACRP,KAAKO,QAGdpB,EAAgBE,UAAU8B,QAAU,SAASf,GAC3C,IAAagB,EAAeN,EAiBLO,EAfvB,KADAP,EAAQd,KAAKY,OAAOC,UAAUC,SACpBQ,UA+BV,OA5BAtB,KAAKY,OAAOC,UAAUC,MAAMA,GAC5BS,SAASC,YAAY,gBAAgB,GAAO,GAC5CD,SAASC,YAAY,YAAY,EAAOpB,GACxCmB,SAASC,YAAY,gBAAgB,GAAO,GAC5CxB,KAAKY,OAAOC,UAAUY,QACtBzB,KAAKY,OAAOC,UAAUC,UACtBM,EAAgBpB,KAAKY,OAAOC,UAAUO,iBACpB,GAAGM,WAAaC,KAAKC,UAC3BR,EAAcS,QAAQ,4BAEtBT,EAAcU,KAAK,6BAEvBC,MAAeV,EAepBrB,KAdM,SAASgC,EAAGC,GACjB,IAAIC,EAAOC,EAGX,OAFAD,EAAQrD,EAAEoD,GACVE,EAAOF,EAAEG,MAAMC,SACX,8BAA8BC,KAAKH,GAC9BD,EAAMK,IAAI,WAAYlB,EAAM3B,QAAQyC,IACzB,WAATA,EACLD,EAAM,GAAGE,MAAMpB,OAAS,EACnBkB,EAAMK,IAAI,WAAY,IAEtBL,EAAMM,YAAYN,EAAMO,iBAJ5B,KASJzC,KAAKY,OAAO8B,QAAQ,iBAG7BzD,EAASD,QAAQ2D,UAAUxD,GAEpBA","file":"../../buttons/FontScaleButton.js","sourcesContent":["define([\r\n  \"skylark-jquery\",\r\n  \"../_extend\",\r\n  \"../Module\",\r\n  \"../Toolbar\",\r\n  \"../Simditor\",\r\n  \"../Button\"\r\n],function($,extend,SimpleModule,Toolbar,Simditor,Button){ \r\n   var FontScaleButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n\r\n  FontScaleButton.prototype.name = 'fontScale';\r\n\r\n  FontScaleButton.prototype.icon = 'font';\r\n\r\n  FontScaleButton.prototype.htmlTag = 'span';\r\n\r\n  FontScaleButton.prototype.disableTag = 'pre, h1, h2, h3, h4, h5';\r\n\r\n  FontScaleButton.prototype.sizeMap = {\r\n    'x-large': '1.5em',\r\n    'large': '1.25em',\r\n    'small': '.75em',\r\n    'x-small': '.5em'\r\n  };\r\n\r\n  FontScaleButton.prototype._init = function() {\r\n    this.menu = [\r\n      {\r\n        name: '150%',\r\n        text: this._t('fontScaleXLarge'),\r\n        param: '5'\r\n      }, {\r\n        name: '125%',\r\n        text: this._t('fontScaleLarge'),\r\n        param: '4'\r\n      }, {\r\n        name: '100%',\r\n        text: this._t('fontScaleNormal'),\r\n        param: '3'\r\n      }, {\r\n        name: '75%',\r\n        text: this._t('fontScaleSmall'),\r\n        param: '2'\r\n      }, {\r\n        name: '50%',\r\n        text: this._t('fontScaleXSmall'),\r\n        param: '1'\r\n      }\r\n    ];\r\n    return Button.prototype._init.call(this);\r\n  };\r\n\r\n  FontScaleButton.prototype._activeStatus = function() {\r\n    var active, endNode, endNodes, range, startNode, startNodes;\r\n    range = this.editor.selection.range();\r\n    startNodes = this.editor.selection.startNodes();\r\n    endNodes = this.editor.selection.endNodes();\r\n    startNode = startNodes.filter('span[style*=\"font-size\"]');\r\n    endNode = endNodes.filter('span[style*=\"font-size\"]');\r\n    active = startNodes.length > 0 && endNodes.length > 0 && startNode.is(endNode);\r\n    this.setActive(active);\r\n    return this.active;\r\n  };\r\n\r\n  FontScaleButton.prototype.command = function(param) {\r\n    var $scales, containerNode, range;\r\n    range = this.editor.selection.range();\r\n    if (range.collapsed) {\r\n      return;\r\n    }\r\n    this.editor.selection.range(range);\r\n    document.execCommand('styleWithCSS', false, true);\r\n    document.execCommand('fontSize', false, param);\r\n    document.execCommand('styleWithCSS', false, false);\r\n    this.editor.selection.reset();\r\n    this.editor.selection.range();\r\n    containerNode = this.editor.selection.containerNode();\r\n    if (containerNode[0].nodeType === Node.TEXT_NODE) {\r\n      $scales = containerNode.closest('span[style*=\"font-size\"]');\r\n    } else {\r\n      $scales = containerNode.find('span[style*=\"font-size\"]');\r\n    }\r\n    $scales.each((function(_this) {\r\n      return function(i, n) {\r\n        var $span, size;\r\n        $span = $(n);\r\n        size = n.style.fontSize;\r\n        if (/large|x-large|small|x-small/.test(size)) {\r\n          return $span.css('fontSize', _this.sizeMap[size]);\r\n        } else if (size === 'medium') {\r\n          if ($span[0].style.length > 1) {\r\n            return $span.css('fontSize', '');\r\n          } else {\r\n            return $span.replaceWith($span.contents());\r\n          }\r\n        }\r\n      };\r\n    })(this));\r\n    return this.editor.trigger('valuechanged');\r\n  };\r\n\r\n  Simditor.Toolbar.addButton(FontScaleButton);\r\n\r\n  return FontScaleButton;\r\n\r\n});"]}