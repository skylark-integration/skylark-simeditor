{"version":3,"sources":["buttons/ListButton.js"],"names":["define","noder","$","Toolbar","Simditor","Button","ListButton","inherit","prototype","type","disableTag","command","param","$list","$rootNodes","anotherType","_this","this","editor","selection","blockNodes","save","each","i","node","$node","is","util","isDecoratedNode","contains","document","children","li","insertAfter","append","html","phBr","insertBefore","remove","contents","replaceAll","prev","appendTo","find","restore","trigger"],"mappings":";;;;;;;AAAAA,QACE,0BACA,0BACA,aACA,cACA,aACA,SAASC,EAAMC,EAAEC,EAAQC,EAASC,GAClC,IAAIC,EAAaD,EAAOE,YA8CtB,OAzCAD,EAAWE,UAAUC,KAAO,GAE5BH,EAAWE,UAAUE,WAAa,aAElCJ,EAAWE,UAAUG,QAAU,SAASC,GACtC,IAAIC,EAAOC,EAAYC,EAKGC,EA4B1B,OAhCAF,EAAaG,KAAKC,OAAOC,UAAUC,aACnCL,EAA4B,OAAdE,KAAKR,KAAgB,KAAO,KAC1CQ,KAAKC,OAAOC,UAAUE,OACtBR,EAAQ,KACRC,EAAWQ,MAAeN,EA0BvBC,KAzBM,SAASM,EAAGC,GACjB,IAAIC,EAEJ,MADAA,EAAQvB,EAAEsB,IACAE,GAAG,mBAAqBD,EAAMC,GAAGV,EAAMN,aAAeM,EAAME,OAAOS,KAAKC,gBAAgBH,KAAWxB,EAAM4B,SAASC,SAAUN,GAGtI,OAAIC,EAAMC,GAAGV,EAAMP,OACjBgB,EAAMM,SAAS,MAAMT,KAAK,SAASC,EAAGS,GAIpC,OAFM9B,EAAE8B,GACSD,SAAS,UAAUE,YAAYR,GACzCvB,EAAE,QAAQgC,OAAOhC,EAAE8B,GAAIG,QAAUnB,EAAME,OAAOS,KAAKS,MAAMC,aAAaZ,KAExEA,EAAMa,UACJb,EAAMC,GAAGX,GACXb,EAAE,IAAMc,EAAMP,KAAO,MAAMyB,OAAOT,EAAMc,YAAYC,WAAWf,GAC7DZ,GAASY,EAAMgB,OAAOf,GAAGb,IAClCX,EAAE,SAASgC,OAAOT,EAAMU,QAAUnB,EAAME,OAAOS,KAAKS,MAAMM,SAAS7B,GAC5DY,EAAMa,YAEbzB,EAAQX,EAAE,IAAMc,EAAMP,KAAO,eAAiBO,EAAMP,KAAO,MACrDkC,KAAK,MAAMT,OAAOT,EAAMU,QAAUnB,EAAME,OAAOS,KAAKS,MACnDvB,EAAM2B,WAAWf,OAI9BR,KAAKC,OAAOC,UAAUyB,UACf3B,KAAKC,OAAO2B,QAAQ,iBAGtBvC","file":"../../buttons/ListButton.js","sourcesContent":["define([\r\n  \"skylark-utils-dom/noder\",\r\n  \"skylark-utils-dom/query\",\r\n  \"../Toolbar\",\r\n  \"../Simditor\",\r\n  \"../Button\"\r\n],function(noder,$,Toolbar,Simditor,Button){ \r\n  var ListButton = Button.inherit({\r\n\r\n   });\r\n\r\n\r\n    ListButton.prototype.type = '';\r\n\r\n    ListButton.prototype.disableTag = 'pre, table';\r\n\r\n    ListButton.prototype.command = function(param) {\r\n      var $list, $rootNodes, anotherType;\r\n      $rootNodes = this.editor.selection.blockNodes();\r\n      anotherType = this.type === 'ul' ? 'ol' : 'ul';\r\n      this.editor.selection.save();\r\n      $list = null;\r\n      $rootNodes.each((function(_this) {\r\n        return function(i, node) {\r\n          var $node;\r\n          $node = $(node);\r\n          if ($node.is('blockquote, li') || $node.is(_this.disableTag) || _this.editor.util.isDecoratedNode($node) || !noder.contains(document, node)) {\r\n            return;\r\n          }\r\n          if ($node.is(_this.type)) {\r\n            $node.children('li').each(function(i, li) {\r\n              var $childList, $li;\r\n              $li = $(li);\r\n              $childList = $li.children('ul, ol').insertAfter($node);\r\n              return $('<p/>').append($(li).html() || _this.editor.util.phBr).insertBefore($node);\r\n            });\r\n            return $node.remove();\r\n          } else if ($node.is(anotherType)) {\r\n            return $('<' + _this.type + '/>').append($node.contents()).replaceAll($node);\r\n          } else if ($list && $node.prev().is($list)) {\r\n            $('<li/>').append($node.html() || _this.editor.util.phBr).appendTo($list);\r\n            return $node.remove();\r\n          } else {\r\n            $list = $(\"<\" + _this.type + \"><li></li></\" + _this.type + \">\");\r\n            $list.find('li').append($node.html() || _this.editor.util.phBr);\r\n            return $list.replaceAll($node);\r\n          }\r\n        };\r\n      })(this));\r\n      this.editor.selection.restore();\r\n      return this.editor.trigger('valuechanged');\r\n    };\r\n\r\n    return ListButton;\r\n\t\r\n});"]}