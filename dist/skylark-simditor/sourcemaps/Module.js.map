{"version":3,"sources":["Module.js"],"names":["define","langx","$","Module","Evented","inherit","init","opts","base","cls","i","instance","instances","len","name","this","extend","constructor","_connectedClasses","ref","results","length","pluginName","charAt","toLowerCase","slice","prototype","_connected","_module","push","call","_init","trigger","obj","key","val","extended","include","included","connect","Error","triggerHandler","type","data","args","concat","apply","_t","arguments","Array","result","i18n","locale","replace","p0","p","position","parseInt","shift","zh-CN"],"mappings":"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","file":"../Module.js","sourcesContent":["define([\n  \"skylark-langx/langx\",\n  \"skylark-jquery\"\n], function (langx,$) {\n\n  var  slice = [].slice;\n\n  var Module = langx.Evented.inherit({\n    init : function (opts) {\n      var base, cls, i, instance, instances, len, name;\n      this.opts = $.extend({}, this.opts, opts);\n      (base = this.constructor)._connectedClasses || (base._connectedClasses = []);\n      instances = (function() {\n        var i, len, ref, results;\n        ref = this.constructor._connectedClasses;\n        results = [];\n        for (i = 0, len = ref.length; i < len; i++) {\n          cls = ref[i];\n          name = cls.pluginName.charAt(0).toLowerCase() + cls.pluginName.slice(1);\n          if (cls.prototype._connected) {\n            cls.prototype._module = this;\n          }\n          results.push(this[name] = new cls());\n        }\n        return results;\n      }).call(this);\n      if (this._connected) {\n        this.opts = $.extend({}, this.opts, this._module.opts);\n      } else {\n        this._init();\n        for (i = 0, len = instances.length; i < len; i++) {\n          instance = instances[i];\n          if (typeof instance._init === \"function\") {\n            instance._init();\n          }\n        }\n      }\n      this.trigger('initialized');\n    }\n\n  });\n\n\n  Module.extend = function(obj) {\n    var key, ref, val;\n    if (!((obj != null) && typeof obj === 'object')) {\n      return;\n    }\n    for (key in obj) {\n      val = obj[key];\n      if (key !== 'included' && key !== 'extended') {\n        this[key] = val;\n      }\n    }\n    return (ref = obj.extended) != null ? ref.call(this) : void 0;\n  };\n\n  Module.include = function(obj) {\n    var key, ref, val;\n    if (!((obj != null) && typeof obj === 'object')) {\n      return;\n    }\n    for (key in obj) {\n      val = obj[key];\n      if (key !== 'included' && key !== 'extended') {\n        this.prototype[key] = val;\n      }\n    }\n    return (ref = obj.included) != null ? ref.call(this) : void 0;\n  };\n\n  Module.connect = function(cls) {\n    if (typeof cls !== 'function') {\n      return;\n    }\n    if (!cls.pluginName) {\n      throw new Error('Module.connect: cannot connect plugin without pluginName');\n      return;\n    }\n    cls.prototype._connected = true;\n    if (!this._connectedClasses) {\n      this._connectedClasses = [];\n    }\n    this._connectedClasses.push(cls);\n    if (cls.pluginName) {\n      return this[cls.pluginName] = cls;\n    }\n  };\n\n  Module.prototype.opts = {};\n\n\n  Module.prototype._init = function() {};\n\n/*\n  Module.prototype.on = function() {\n    var args, ref;\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\n    (ref = $(this)).on.apply(ref, args);\n    return this;\n  };\n\n  Module.prototype.one = function() {\n    var args, ref;\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\n    (ref = $(this)).one.apply(ref, args);\n    return this;\n  };\n\n  Module.prototype.off = function() {\n    var args, ref;\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\n    (ref = $(this)).off.apply(ref, args);\n    return this;\n  };\n\n  Module.prototype.trigger = function() {\n    var args, ref;\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\n    (ref = $(this)).trigger.apply(ref, args);\n    return this;\n  };\n\n  Module.prototype.triggerHandler = function() {\n    var args, ref;\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\n    return (ref = $(this)).triggerHandler.apply(ref, args);\n  };\n*/\n\n  Module.prototype.triggerHandler =  Module.prototype.trigger = function(type,data) {\n    var args, ref;\n    args = [type];\n    if (data) {\n      args = args.concat(data);\n    }\n    langx.Evented.prototype.trigger.apply(this, args);\n    return this;\n  };\n\n  Module.prototype._t = function() {\n    var args, ref;\n    args = 1 <= arguments.length ? Array.prototype.slice.call(arguments, 0) : [];\n    return (ref = this.constructor)._t.apply(ref, args);\n  };\n\n  Module._t = function() {\n    var args, key, ref, result;\n    key = arguments[0], args = 2 <= arguments.length ? Array.prototype.slice.call(arguments, 1) : [];\n    result = ((ref = this.i18n[this.locale]) != null ? ref[key] : void 0) || '';\n    if (!(args.length > 0)) {\n      return result;\n    }\n    result = result.replace(/([^%]|^)%(?:(\\d+)\\$)?s/g, function(p0, p, position) {\n      if (position) {\n        return p + args[parseInt(position) - 1];\n      } else {\n        return p + args.shift();\n      }\n    });\n    return result.replace(/%%s/g, '%s');\n  };\n\n  Module.i18n = {\n    'zh-CN': {}\n  };\n\n  Module.locale = 'zh-CN';\n\n  return Module;\n\n\n});\n"]}