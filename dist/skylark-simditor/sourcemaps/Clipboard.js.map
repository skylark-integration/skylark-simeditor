{"version":3,"sources":["Clipboard.js"],"names":["define","langx","$","Clipboard","Evented","inherit","pluginName","prototype","opts","pasteImage","cleanPaste","init","editor","_this","this","body","on","e","range","pasting","_pasteBin","triggerHandler","selection","deleteRangeContents","html","collapsed","collapse","formatter","format","setRangeAtStartOf","find","_processPasteByClipboardApi","inputManager","throttledValueChanged","clear","throttledSelectionChanged","undoManager","throttledPushState","reset","resetCaretPosition","_getPasteContent","pasteContent","_processPasteContent","_pasteInBlockEl","_pastePlainText","imageFile","pasteItem","ref","uploadOpt","util","browser","edge","originalEvent","clipboardData","items","length","test","type","getAsFile","name","uploader","upload","callback","state","addClass","attr","appendTo","el","caret","caretPosition","focus","setTimeout","hidePopover","get","innerHTML","blockNodes","last","is","clearHtml","append","contents","remove","_cleanPasteFontSize","decorate","beautify","children","$blockEl","$img","blob","dataURLtoBlob","img","insertPosition","k","l","lastLine","len","len1","len2","len3","len4","line","lines","m","node","o","q","ref1","ref2","split","pop","insertNode","document","createTextNode","text","css","RegExp","location","origin","Image","onload","canvas","createElement","width","naturalWidth","height","naturalHeight","getContext","drawImage","toDataURL","src","isEmptyNode","replaceWith","setRangeAtEndOf","parent","after","rangeAtStartOf","rangeAtEndOf","breakBlockEl","$node","sizeMap","map","i","$el","inArray"],"mappings":"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","file":"../Clipboard.js","sourcesContent":["define([\r\n  \"skylark-langx/langx\",\r\n  \"skylark-jquery\"\r\n],function(langx,$){ \r\n\r\n\r\n  var Clipboard = langx.Evented.inherit({\r\n\r\n  });\r\n\r\n\r\n  Clipboard.pluginName = 'Clipboard';\r\n\r\n  Clipboard.prototype.opts = {\r\n    pasteImage: false,\r\n    cleanPaste: false\r\n  };\r\n\r\n  Clipboard.prototype.init = function(editor) {\r\n    this.editor = editor; //this._module;\r\n    if (this.opts.pasteImage && typeof this.opts.pasteImage !== 'string') {\r\n      this.opts.pasteImage = 'inline';\r\n    }\r\n    this.editor.body.on('paste', (function(_this) {\r\n      return function(e) {\r\n        var range;\r\n        if (_this.pasting || _this._pasteBin) {\r\n          return;\r\n        }\r\n        if (_this.editor.triggerHandler(e) === false) {\r\n          return false;\r\n        }\r\n        range = _this.editor.selection.deleteRangeContents();\r\n        if (_this.editor.body.html()) {\r\n          if (!range.collapsed) {\r\n            range.collapse(true);\r\n          }\r\n        } else {\r\n          _this.editor.formatter.format();\r\n          _this.editor.selection.setRangeAtStartOf(_this.editor.body.find('p:first'));\r\n        }\r\n        if (_this._processPasteByClipboardApi(e)) {\r\n          return false;\r\n        }\r\n        _this.editor.inputManager.throttledValueChanged.clear();\r\n        _this.editor.inputManager.throttledSelectionChanged.clear();\r\n        _this.editor.undoManager.throttledPushState.clear();\r\n        _this.editor.selection.reset();\r\n        _this.editor.undoManager.resetCaretPosition();\r\n        _this.pasting = true;\r\n        return _this._getPasteContent(function(pasteContent) {\r\n          _this._processPasteContent(pasteContent);\r\n          _this._pasteInBlockEl = null;\r\n          _this._pastePlainText = null;\r\n          return _this.pasting = false;\r\n        });\r\n      };\r\n    })(this));\r\n  };\r\n\r\n  Clipboard.prototype._processPasteByClipboardApi = function(e) {\r\n    var imageFile, pasteItem, ref, uploadOpt;\r\n    if (this.editor.util.browser.edge) {\r\n      return;\r\n    }\r\n    if (e.originalEvent.clipboardData && e.originalEvent.clipboardData.items && e.originalEvent.clipboardData.items.length > 0) {\r\n      pasteItem = e.originalEvent.clipboardData.items[0];\r\n      if (/^image\\//.test(pasteItem.type)) {\r\n        imageFile = pasteItem.getAsFile();\r\n        if (!((imageFile != null) && this.opts.pasteImage)) {\r\n          return;\r\n        }\r\n        if (!imageFile.name) {\r\n          imageFile.name = \"Clipboard Image.png\";\r\n        }\r\n        if (this.editor.triggerHandler('pasting', [imageFile]) === false) {\r\n          return;\r\n        }\r\n        uploadOpt = {};\r\n        uploadOpt[this.opts.pasteImage] = true;\r\n        if ((ref = this.editor.uploader) != null) {\r\n          ref.upload(imageFile, uploadOpt);\r\n        }\r\n        return true;\r\n      }\r\n    }\r\n  };\r\n\r\n  Clipboard.prototype._getPasteContent = function(callback) {\r\n    var state;\r\n    this._pasteBin = $('<div contenteditable=\"true\" />').addClass('simditor-paste-bin').attr('tabIndex', '-1').appendTo(this.editor.el);\r\n    state = {\r\n      html: this.editor.body.html(),\r\n      caret: this.editor.undoManager.caretPosition()\r\n    };\r\n    this._pasteBin.focus();\r\n    return setTimeout((function(_this) {\r\n      return function() {\r\n        var pasteContent;\r\n        _this.editor.hidePopover();\r\n        _this.editor.body.get(0).innerHTML = state.html;\r\n        _this.editor.undoManager.caretPosition(state.caret);\r\n        _this.editor.body.focus();\r\n        _this.editor.selection.reset();\r\n        _this.editor.selection.range();\r\n        _this._pasteInBlockEl = _this.editor.selection.blockNodes().last();\r\n        _this._pastePlainText = _this.opts.cleanPaste || _this._pasteInBlockEl.is('pre, table');\r\n        if (_this._pastePlainText) {\r\n          pasteContent = _this.editor.formatter.clearHtml(_this._pasteBin.html(), true);\r\n        } else {\r\n          pasteContent = $('<div/>').append(_this._pasteBin.contents());\r\n          pasteContent.find('style').remove();\r\n          pasteContent.find('table colgroup').remove();\r\n          _this._cleanPasteFontSize(pasteContent);\r\n          _this.editor.formatter.format(pasteContent);\r\n          _this.editor.formatter.decorate(pasteContent);\r\n          _this.editor.formatter.beautify(pasteContent.children());\r\n          pasteContent = pasteContent.contents();\r\n        }\r\n        _this._pasteBin.remove();\r\n        _this._pasteBin = null;\r\n        return callback(pasteContent);\r\n      };\r\n    })(this), 0);\r\n  };\r\n\r\n  Clipboard.prototype._processPasteContent = function(pasteContent) {\r\n    var $blockEl, $img, blob, children, dataURLtoBlob, img, insertPosition, k, l, lastLine, len, len1, len2, len3, len4, line, lines, m, node, o, q, ref, ref1, ref2, uploadOpt, uploader;\r\n    if (this.editor.triggerHandler('pasting', [pasteContent]) === false) {\r\n      return;\r\n    }\r\n    $blockEl = this._pasteInBlockEl;\r\n    if (!pasteContent) {\r\n      return;\r\n    }\r\n    if (this._pastePlainText) {\r\n      if ($blockEl.is('table')) {\r\n        lines = pasteContent.split('\\n');\r\n        lastLine = lines.pop();\r\n        for (k = 0, len = lines.length; k < len; k++) {\r\n          line = lines[k];\r\n          this.editor.selection.insertNode(document.createTextNode(line));\r\n          this.editor.selection.insertNode($('<br/>'));\r\n        }\r\n        this.editor.selection.insertNode(document.createTextNode(lastLine));\r\n      } else {\r\n        pasteContent = $('<div/>').text(pasteContent);\r\n        ref = pasteContent.contents();\r\n        for (l = 0, len1 = ref.length; l < len1; l++) {\r\n          node = ref[l];\r\n          this.editor.selection.insertNode($(node)[0]);\r\n        }\r\n      }\r\n    } else if ($blockEl.is(this.editor.body)) {\r\n      for (m = 0, len2 = pasteContent.length; m < len2; m++) {\r\n        node = pasteContent[m];\r\n        this.editor.selection.insertNode(node);\r\n      }\r\n    } else if (pasteContent.length < 1) {\r\n      return;\r\n    } else if (pasteContent.length === 1) {\r\n      if (pasteContent.is('p')) {\r\n        children = pasteContent.contents();\r\n        if ($blockEl.is('h1, h2, h3, h4, h5')) {\r\n          if (children.length) {\r\n            children.css('font-size', '');\r\n          }\r\n        }\r\n        if (children.length === 1 && children.is('img')) {\r\n          $img = children;\r\n          if (/^data:image/.test($img.attr('src'))) {\r\n            if (!this.opts.pasteImage) {\r\n              return;\r\n            }\r\n            blob = this.editor.util.dataURLtoBlob($img.attr(\"src\"));\r\n            blob.name = \"Clipboard Image.png\";\r\n            uploadOpt = {};\r\n            uploadOpt[this.opts.pasteImage] = true;\r\n            if ((ref1 = this.editor.uploader) != null) {\r\n              ref1.upload(blob, uploadOpt);\r\n            }\r\n            return;\r\n          } else if (new RegExp('^blob:' + location.origin + '/').test($img.attr('src'))) {\r\n            if (!this.opts.pasteImage) {\r\n              return;\r\n            }\r\n            uploadOpt = {};\r\n            uploadOpt[this.opts.pasteImage] = true;\r\n            dataURLtoBlob = this.editor.util.dataURLtoBlob;\r\n            uploader = this.editor.uploader;\r\n            img = new Image;\r\n            img.onload = function() {\r\n              var canvas;\r\n              canvas = document.createElement('canvas');\r\n              canvas.width = img.naturalWidth;\r\n              canvas.height = img.naturalHeight;\r\n              canvas.getContext('2d').drawImage(img, 0, 0);\r\n              blob = dataURLtoBlob(canvas.toDataURL('image/png'));\r\n              blob.name = 'Clipboard Image.png';\r\n              if (uploader !== null) {\r\n                uploader.upload(blob, uploadOpt);\r\n              }\r\n            };\r\n            img.src = $img.attr('src');\r\n            return;\r\n          } else if ($img.is('img[src^=\"webkit-fake-url://\"]')) {\r\n            return;\r\n          }\r\n        }\r\n        for (o = 0, len3 = children.length; o < len3; o++) {\r\n          node = children[o];\r\n          this.editor.selection.insertNode(node);\r\n        }\r\n      } else if ($blockEl.is('p') && this.editor.util.isEmptyNode($blockEl)) {\r\n        $blockEl.replaceWith(pasteContent);\r\n        this.editor.selection.setRangeAtEndOf(pasteContent);\r\n      } else if (pasteContent.is('ul, ol')) {\r\n        if (pasteContent.find('li').length === 1) {\r\n          pasteContent = $('<div/>').text(pasteContent.text());\r\n          ref2 = pasteContent.contents();\r\n          for (q = 0, len4 = ref2.length; q < len4; q++) {\r\n            node = ref2[q];\r\n            this.editor.selection.insertNode($(node)[0]);\r\n          }\r\n        } else if ($blockEl.is('li')) {\r\n          $blockEl.parent().after(pasteContent);\r\n          this.editor.selection.setRangeAtEndOf(pasteContent);\r\n        } else {\r\n          $blockEl.after(pasteContent);\r\n          this.editor.selection.setRangeAtEndOf(pasteContent);\r\n        }\r\n      } else {\r\n        $blockEl.after(pasteContent);\r\n        this.editor.selection.setRangeAtEndOf(pasteContent);\r\n      }\r\n    } else {\r\n      if ($blockEl.is('li')) {\r\n        $blockEl = $blockEl.parent();\r\n      }\r\n      if (this.editor.selection.rangeAtStartOf($blockEl)) {\r\n        insertPosition = 'before';\r\n      } else if (this.editor.selection.rangeAtEndOf($blockEl)) {\r\n        insertPosition = 'after';\r\n      } else {\r\n        this.editor.selection.breakBlockEl($blockEl);\r\n        insertPosition = 'before';\r\n      }\r\n      $blockEl[insertPosition](pasteContent);\r\n      this.editor.selection.setRangeAtEndOf(pasteContent.last());\r\n    }\r\n    return this.editor.inputManager.throttledValueChanged();\r\n  };\r\n\r\n  Clipboard.prototype._cleanPasteFontSize = function(node) {\r\n    var $node, sizeMap;\r\n    $node = $(node);\r\n    if (!($node.length > 0)) {\r\n      return;\r\n    }\r\n    sizeMap = ['1.5em', '1.25em', '0.75em', '0.5em'];\r\n    return $node.find('[style*=\"font-size\"]').map(function(i, el) {\r\n      var $el;\r\n      $el = $(el);\r\n      if ($.inArray($el.css('font-size'), sizeMap) < 0) {\r\n        return $el.css('font-size', '');\r\n      }\r\n    });\r\n  };\r\n\r\n  return Clipboard;\r\n\r\n});\r\n\r\n"]}