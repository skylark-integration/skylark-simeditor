/**
 * skylark-simditor - A version of simditor.js that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-simditor/
 * @license MIT
 */
define([],function(){"use strict";var t={},e={};function i(t){return"object"!=typeof t||Array.isArray(t)||!function(t){var e;for(e in t)return!1;return!0}(t)}return define(["skylark-langx/langx","skylark-utils-dom/query","skylark-ui-contents/editable","./Toolbar","./uploader","./i18n"],function(t,e,i,r,o,s){var a=t.Evented.inherit({init:function(s){var n,d;if(this.opts=t.extend({},this.opts,s),this.textarea=e(this.opts.textarea),this.opts.placeholder=this.opts.placeholder||this.textarea.attr("placeholder"),!this.textarea.length)throw new Error("simditor: param textarea is required.");null!=(n=this.textarea.data("simditor"))&&n.destroy(),this.id=++a.count,this._render();var h=this;if(this.editable=i(this.el,{classPrefix:"simditor-",textarea:this.textarea,body:this.body}),this.editable.on("all",function(t,e){return h.trigger(t.type,e)}),this.opts.upload&&o&&(d="object"==typeof this.opts.upload?this.opts.upload:{},this.uploader=o(d)),this.toolbar=new r(this,{toolbar:this.opts.toolbar,toolbarFloat:this.opts.toolbarFloat,toolbarHidden:this.opts.toolbarHidden,toolbarFloatOffset:this.opts.toolbarFloatOffset}),this.opts.placeholder&&this.on("valuechanged",function(){return h._placeholder()}),this.setValue(this.textarea.val().trim()||""),this.textarea.attr("autofocus"))return h.focus()}});return a.prototype.triggerHandler=a.prototype.trigger=function(e,i){var r;return r=[e],i&&(r=r.concat(i)),t.Evented.prototype.trigger.apply(this,r),this},a.count=0,a.prototype.opts={textarea:null,placeholder:"",defaultImage:"images/image.png",params:{},upload:!1,indentWidth:40},a.prototype._tpl='<div class="simditor">\n  <div class="simditor-wrapper">\n    <div class="simditor-placeholder"></div>\n    <div class="simditor-body" contenteditable="true">\n    </div>\n  </div>\n</div>',a.prototype._render=function(){var t,i,r,o;if(this.el=e(this._tpl).insertBefore(this.textarea),this.wrapper=this.el.find(".simditor-wrapper"),this.body=this.wrapper.find(".simditor-body"),this.placeholderEl=this.wrapper.find(".simditor-placeholder").append(this.opts.placeholder),this.el.data("simditor",this),this.wrapper.append(this.textarea),this.textarea.data("simditor",this).blur(),this.body.attr("tabindex",this.textarea.attr("tabindex")),this.opts.params){for(t in r=[],i=this.opts.params)o=i[t],r.push(e("<input/>",{type:"hidden",name:t,value:o}).insertAfter(this.textarea));return r}},a.prototype._placeholder=function(){var t;return 0===(t=this.body.children()).length||1===t.length&&this.util.isEmptyNode(t)&&parseInt(t.css("margin-left")||0)<this.opts.indentWidth?this.placeholderEl.show():this.placeholderEl.hide()},a.prototype.setValue=function(t){return this.hidePopover(),this.editable.setValue(t),this.trigger("valuechanged")},a.prototype.getValue=function(){return this.editable.getValue()},a.prototype.focus=function(){return this.editable.focus()},a.prototype.blur=function(){return this.editable.blur()},a.prototype.hidePopover=function(){return this.el.find(".simditor-popover").each(function(t,i){if((i=e(i).data("popover")).active)return i.hide()})},a.prototype.destroy=function(){return this.triggerHandler("destroy"),this.textarea.closest("form").off(".simditor .simditor-"+this.id),this.selection.clear(),this.inputManager.focused=!1,this.textarea.insertBefore(this.el).hide().val("").removeData("simditor"),this.el.remove(),e(document).off(".simditor-"+this.id),e(window).off(".simditor-"+this.id),this.off()},a.Toolbar=r,a.i18n=s,a}),i(e)?e:i(t)?t:void 0});
//# sourceMappingURL=sourcemaps/Simditor.js.map
